---
type: "manual"
---

# GistFans项目工作机制规范

## 📋 核心工作流程

### 必须遵循的执行顺序

1. **查看experience文件** 📖
   - 首先查看 `experiences/history.txt` 了解项目历史和上下文
   - 理解之前的工作内容和当前项目状态
   - 获取必要的背景信息

2. **执行前自检** ✅
   - **当前记忆范围**：明确说明能记住的对话内容从哪个时间点/消息开始到哪个时间点/消息结束
   - **当前目标**：清晰描述理解的当前任务目标是什么
   - **当前状态**：说明认为我们现在正在进行什么具体工作或处于哪个阶段

3. **完成Read阶段** 📚
   - 深入理解用户的核心需求
   - 分析技术要求和业务逻辑
   - 确认理解的准确性

4. **报告执行计划和预期效果** 📊
   - **执行计划**：详细说明将要采取的具体步骤
   - **预期效果**：描述预期达到的技术效果和业务效果
   - **核心需求理解**：体现对用户真实需求的准确把握

5. **获得确认后执行** 🚀
   - 等待用户确认计划可行
   - 按照计划进行具体的代码编辑和实施
   - 严格按照既定计划执行，避免偏离

## 🚫 错误做法警示

### 不允许的行为
- ❌ 直接开始编写代码而不查看experience文件
- ❌ 跳过执行前自检直接进入任务
- ❌ 不报告执行计划就开始实施
- ❌ 对用户需求理解不准确就开始工作

### 之前的错误案例
在社区提案系统优化任务中，我犯了以下错误：
1. 没有先查看experience文件了解背景
2. 直接开始分析代码和编写修复方案
3. 没有充分理解用户的真实需求就开始实施
4. 缺乏系统性的执行计划报告

## 📝 历史记录管理

### 记录维护规则
- 每次完成重要工作后，必须更新 `experiences/history.txt`
- 记录内容包括：讨论的主要内容、完成的任务、重要决策和结论、下一步计划
- 当history.txt达到6000行时，创建history-2.txt继续记录
- 确保历史记录的连续性和可追溯性

### 记忆容量管理
- 主动提醒记忆范围即将超出上下文限制
- 及时进行历史记录总结和归档
- 保持工作的连续性和一致性

## 🔄 Git工作流程

### 常规合作流程
1. 完成代码修改后，必须推送到GitHub
2. 编写有意义的提交信息
3. 确保代码变更的可追溯性
4. 维护良好的版本控制习惯

### 推送前检查
- 确认所有修改文件都已包含
- 验证代码质量和功能完整性
- 编写清晰的提交说明

## 🎯 质量保证原则

### 预防→修复→验证流程
- **预防**：通过充分的前期分析避免问题
- **修复**：系统性地解决发现的问题
- **验证**：确保修复效果符合预期

### 核心价值观
- 质量优于速度
- 用户体验优先
- 系统性分析问题
- 持续改进和学习

## 📚 学习和改进

### 持续优化机制
- 从每次工作中总结经验教训
- 不断完善工作流程和方法
- 建立错误预防机制
- 保持谦逊和学习态度

### 反思要点
- 是否遵循了正确的工作流程？
- 是否充分理解了用户需求？
- 是否提供了高质量的解决方案？
- 是否及时更新了历史记录？

## ⚠️ 严格执行要求 (2025-07-28更新)

### 强制性流程
1. **必须先Read**：开始任何任务前，必须完整读取experiences文件夹中的所有文件
2. **禁止跳跃**：不允许跳过任何阶段，必须按顺序执行
3. **反思记录**：所有反思和经验教训必须写入review.md文件
4. **机制遵循**：严格按照work-mechanism.md的流程执行，不允许直接编辑代码

### 违规后果
- 任何违反机制的行为都必须停止当前任务
- 必须重新从Read阶段开始
- 必须在review.md中记录违规原因和改进措施

## 🔍 v4.0自检流程标准 (从experiences/history.txt和evolution.md提取)

### v4.0自检流程定义
v4.0自检流程是经过实践验证的三阶段质量保证体系，通过**预防→修复→验证**的系统性方法，确保问题的完整解决和质量保证。

### 📋 三阶段自检体系

#### 阶段1：预防性检查 ✅
**目标**: 在修复前发现所有相关问题，避免遗漏

**必须执行的检查项目**:
1. **API函数调用一致性检查**
   - 搜索所有相关API调用
   - 验证参数顺序和数量一致性
   - 检查函数签名的正确使用

2. **接口定义完整性检查**
   - 搜索所有对象属性使用
   - 验证接口定义包含所有使用的属性
   - 检查可选属性的正确使用

3. **类型安全预检查**
   - 运行TypeScript编译检查
   - 检查ESLint类型相关警告
   - 验证导入导出的类型匹配

#### 阶段2：系统性修复 ✅
**目标**: 一次性解决所有相关问题，避免重复修复

**必须执行的修复流程**:
1. **错误根因分析**
   - 理解错误的根本原因，不只是表面现象
   - 识别是否为系统性问题还是局部问题
   - 分析是否存在相同模式的其他错误

2. **全面问题搜索**
   - 搜索相同函数的所有调用
   - 搜索相同模式的所有使用
   - 检查相关文件的类似问题

3. **系统性修复**
   - 一次性修复所有相关问题
   - 建立统一的调用模式
   - 更新相关文档和注释

#### 阶段3：质量保证验证 ✅
**目标**: 确保修复的完整性和稳定性

**必须执行的验证项目**:
1. **多层构建验证**
   - TypeScript编译检查：必须通过
   - ESLint规则验证：无错误
   - Next.js构建验证：成功构建

2. **回归测试检查**
   - 验证修复没有引入新问题
   - 检查相关功能的完整性
   - 确认API调用的一致性

3. **功能完整性测试**
   - 实际运行和测试每个修复的功能
   - 从用户角度验证问题是否真正解决
   - 测试数据的准确性和一致性

### ⚠️ v4.0自检流程执行要求

#### 强制性要求
1. **必须按顺序执行**: 不允许跳过任何阶段
2. **必须完成所有检查项**: 每个阶段的所有检查项都必须执行
3. **必须记录执行过程**: 在review.md中详细记录每个阶段的执行结果
4. **必须诚实报告**: 如实报告发现的所有问题，不允许虚假声明

#### 质量标准
- **预防性检查**: 必须发现所有相关问题，不允许遗漏
- **系统性修复**: 必须一次性解决所有相关问题
- **质量保证验证**: 必须通过所有验证项目，包括实际功能测试

#### 违规后果
- 任何虚假声明v4.0自检通过的行为都是欺诈
- 必须重新从阶段1开始执行完整的v4.0自检流程
- 必须在review.md中记录违规原因和深度反思

## 🛑 强制60秒分析机制 (防止急于求成)

### 机制目的
防止急于求成、跳过流程、虚假自检等欺诈行为，确保每次工作都经过深度思考和充分准备。

### 📋 强制60秒自问四个问题

收到任何任务后，必须强制暂停60秒，并诚实回答以下四个问题：

#### 问题1：我是否完整理解了用户的真实需求？
**检查标准**:
- [ ] 是否完整阅读了用户的所有描述？
- [ ] 是否理解了问题的根本原因？
- [ ] 是否明确了用户期望的结果？
- [ ] 是否识别了隐含的需求？

#### 问题2：我是否已经完整读取了所有相关文档？
**检查标准**:
- [ ] 是否完整读取了experiences文件夹中的所有文件？
- [ ] 是否查看了相关的代码文件和配置？
- [ ] 是否了解了历史修复的经验教训？
- [ ] 是否掌握了当前的工作标准和流程？

#### 问题3：我是否制定了详细的执行计划？
**检查标准**:
- [ ] 是否分析了问题的根本原因？
- [ ] 是否制定了具体的修复步骤？
- [ ] 是否考虑了可能的风险和副作用？
- [ ] 是否准备了验证和测试方案？

#### 问题4：我是否准备好接受修复可能失败的现实？
**检查标准**:
- [ ] 是否承认自己的能力局限性？
- [ ] 是否准备好诚实报告问题？
- [ ] 是否接受需要多次迭代的可能？
- [ ] 是否优先考虑质量而非速度？

### ⚠️ 执行要求

#### 强制性规则
1. **必须暂停60秒**: 不允许立即开始工作，必须强制思考
2. **必须诚实回答**: 不允许虚假的"是"，必须基于真实情况
3. **必须全部为"是"**: 只有四个问题都是"是"才能开始工作
4. **必须记录过程**: 在工作记录中明确记录自问过程

#### 违规处理
- 如果任何问题是"否"，必须立即停止，完成相应的准备工作
- 如果发现虚假回答，必须重新开始整个流程
- 如果跳过此机制，视为严重违规，必须深度反思

### 🎯 机制价值

#### 预防效果
- **防止急于求成**: 强制思考时间，避免冲动行为
- **确保充分准备**: 确保在充分理解和准备后才开始工作
- **提高质量意识**: 强化"质量优于速度"的价值观
- **建立诚实习惯**: 培养诚实面对问题的习惯

#### 质量保证
- **减少返工**: 充分准备减少后续的修复和返工
- **提高成功率**: 深度思考提高解决方案的成功率
- **避免欺诈**: 防止虚假声明和自我欺骗
- **建立标准**: 建立一致的工作质量标准

---

**创建时间**：2025-07-28
**更新时间**：2025-07-28 (添加v4.0自检流程标准)
**版本**：v2.0
**状态**：已确立并开始执行

此文档将作为GistFans项目合作的标准工作机制，所有后续工作都必须严格遵循此流程。v4.0自检流程是质量保证的核心，任何违反都是对项目质量的严重威胁。
