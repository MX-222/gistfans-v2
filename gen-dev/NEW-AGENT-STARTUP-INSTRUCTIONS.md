# 🚀 GistFans项目新Agent启动指令

## ⚠️ 强制性启动流程 - 必须完成所有步骤

**重要提醒**: 这不是可选的建议，而是强制性的启动流程。跳过任何步骤都会导致开发错误和项目延误。

---

## 🔒 第一阶段：强制性文档阅读验证 (必须完成)

### **步骤1: 立即阅读核心交接文档**
```bash
# 必须按顺序阅读以下文件，不允许跳过：
1. gen-dev/admin-development-handover.md    # 🔥 最重要 - 管理员开发状态
2. gen-dev/development-standards.md         # 📏 开发规范要求
3. experiences/history.txt                  # 📚 项目历史背景
```

### **步骤2: 强制验证问题 (必须正确回答)**
阅读完成后，你必须能够回答以下问题：

**验证问题A: 项目状态理解**
- 管理员功能当前完成度是多少？
- 下一步最紧急的3个开发任务是什么？
- 哪个组件需要从40%完善到90%？

**验证问题B: 技术要求理解**
- 管理员功能的安全要求有哪些？
- 操作审计日志需要创建哪个数据库模型？
- TypeScript严格模式的具体要求是什么？

**验证问题C: 实际操作理解**
- 如何创建管理员账户进行测试？
- 管理员面板的访问路径是什么？
- 综合功能测试的命令是什么？

**🚫 如果无法回答上述问题，必须重新阅读文档，不允许继续下一步骤。**

---

## 🎯 第二阶段：核心信息掌握 (5分钟速览)

### **当前项目状态核心要点**
```
✅ 已完成 (90%+):
- 管理员认证系统 (GitHub OAuth + 安全入口)
- 邀请码管理系统 (生成、使用、统计)
- 数据库健康监控 (连接池、性能指标)

🟡 部分完成 (需要完善):
- 用户管理UI (40% → 需要达到90%)
- 系统统计面板 (30% → 需要达到80%)
- 内容审核工具 (20% → 需要达到70%)

❌ 待开发 (0%):
- 操作审计日志系统 (最高优先级)
- 批量操作功能
- 高级权限管理
```

### **技术栈核心信息**
```
- Next.js 15.3.5 + React 18.3.1 + TypeScript (严格模式)
- Prisma 6.12.0 + Supabase PostgreSQL (15个数据模型)
- NextAuth.js 4.24.11 (GitHub OAuth认证)
- Tailwind CSS 3.4.4 + shadcn/ui (UI组件)
- 连接池: 35个连接，30秒超时
```

---

## ⚡ 第三阶段：立即执行验证 (必须成功)

### **步骤1: 环境验证命令**
```bash
# 必须依次执行以下命令，确保所有命令都成功：

# 1. 创建管理员账户 (必须成功)
node scripts/create-admin.js

# 2. 运行综合功能测试 (必须通过)
node scripts/test-all-four-fixes.js

# 3. 验证管理员功能 (必须能访问)
# 在浏览器中访问以下URL:
# http://localhost:3000/secret-admin-portal
# http://localhost:3000/admin-dashboard
# http://localhost:3000/admin/invites

# 4. 数据库健康检查 (必须正常)
node scripts/diagnose-connection-pool.js
```

### **步骤2: 开发环境检查**
```bash
# 必须确保以下检查都通过：
npm run type-check          # TypeScript检查 - 必须无错误
npm run lint                # ESLint检查 - 必须无警告
npm run build               # 构建检查 - 必须成功
```

**🚫 如果任何命令失败，必须先解决问题，不允许继续开发工作。**

---

## 🎯 第四阶段：下一步开发任务 (明确优先级)

### **🔥 最高优先级任务 (立即开始)**

#### **任务1: 完善用户管理UI (1-2周)**
```
文件: src/components/admin/AdminUserManagement.tsx
当前状态: 40%完成
目标状态: 90%完成

具体任务:
- [ ] 用户列表表格优化 (排序、筛选、分页)
- [ ] 用户操作按钮 (角色修改、禁用/启用)
- [ ] 用户详情弹窗
- [ ] 批量操作功能
- [ ] 操作确认对话框
```

#### **任务2: 操作审计日志系统 (1-2周)**
```
当前状态: 0%完成
目标状态: 80%完成

需要创建:
1. 数据库模型: AdminLog
2. API端点: /api/admin/logs
3. 前端组件: AdminLogViewer.tsx

具体实现:
model AdminLog {
  id          String   @id @default(cuid())
  adminId     String
  action      String
  targetType  String
  targetId    String
  details     Json?
  ipAddress   String?
  createdAt   DateTime @default(now())
}
```

#### **任务3: 系统统计面板 (1-2周)**
```
文件: src/app/admin-dashboard/page.tsx
当前状态: 30%完成
目标状态: 80%完成

需要实现:
- [ ] 用户增长统计 (日/周/月)
- [ ] 内容统计 (帖子、评论、Star投票)
- [ ] 活跃度统计 (DAU、MAU)
- [ ] 系统性能统计
```

---

## 📏 第五阶段：开发标准要求 (必须遵循)

### **代码质量强制要求**
```typescript
// 1. TypeScript严格模式 - 必须无错误
✅ 无TypeScript错误
✅ 无ESLint警告
✅ 完整的类型定义
✅ 适当的错误处理

// 2. API响应格式 - 必须统一
interface APIResponse<T> {
  success: boolean
  data?: T
  error?: {
    code: string
    message: string
  }
}

// 3. 安全要求 - 管理员功能极其重要
- 所有管理员API必须有严格权限检查
- 所有操作必须记录审计日志
- 输入验证和XSS防护必须完善
```

### **关键文件路径**
```
管理员页面:
- src/app/admin-dashboard/
- src/app/admin/
- src/app/secret-admin-portal/

管理员API:
- src/app/api/admin/

管理员组件:
- src/components/admin/

测试脚本:
- scripts/test-*.js
- scripts/create-admin.js
```

---

## ✅ 第六阶段：成功标准检查 (必须达到)

### **启动成功标准**
在开始任何开发工作之前，你必须确认：

```
□ 已完整阅读所有必读文档
□ 能正确回答所有验证问题
□ 所有验证命令都执行成功
□ 能访问所有管理员页面
□ 理解下一步开发任务的具体要求
□ 掌握开发标准和安全要求
□ 知道所有关键文件路径
```

### **开发准备就绪标准**
```
□ 管理员账户创建成功
□ 开发环境检查全部通过
□ 能够访问管理员面板
□ 理解当前代码结构
□ 明确第一个任务的具体实现步骤
```

---

## 🚫 防止跳过阅读的强制验证

### **验证机制**
1. **必须回答验证问题**: 无法回答说明未认真阅读
2. **必须执行验证命令**: 命令失败说明环境有问题
3. **必须访问管理员页面**: 无法访问说明理解不足
4. **必须明确下一步任务**: 不清楚说明准备不充分

### **违规后果**
如果发现以下行为，必须重新开始启动流程：
- 声称已阅读但无法回答验证问题
- 跳过验证命令直接开始开发
- 对项目状态理解错误
- 不遵循开发标准要求

---

## 🎯 立即行动清单

### **现在就执行 (5分钟内)**
1. ✅ 阅读 `admin-development-handover.md`
2. ✅ 回答验证问题A、B、C
3. ✅ 执行 `node scripts/create-admin.js`
4. ✅ 执行 `node scripts/test-all-four-fixes.js`
5. ✅ 访问管理员面板验证功能

### **接下来执行 (10分钟内)**
1. ✅ 阅读 `development-standards.md`
2. ✅ 检查开发环境 (`npm run type-check`, `npm run lint`)
3. ✅ 熟悉关键文件路径
4. ✅ 理解第一个开发任务的具体要求

### **开始开发前 (15分钟内)**
1. ✅ 确认所有成功标准都已达到
2. ✅ 制定第一个任务的具体实施计划
3. ✅ 开始用户管理UI的完善工作

---

## 📞 支持和帮助

如果在启动过程中遇到问题：
1. **首先**: 重新阅读相关文档
2. **然后**: 检查命令执行是否正确
3. **最后**: 确认环境配置是否正确

**记住**: 这个启动流程是为了确保你能够高效、安全地继续项目开发。每个步骤都有其重要意义，不允许跳过。

---

**启动指令版本**: v1.0  
**创建时间**: 2025-07-28  
**适用范围**: 所有新Agent启动  
**强制执行**: 必须完成所有步骤才能开始开发
